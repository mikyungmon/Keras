# Chapter 02 # 

**인공신경망(Artificial Neural Network)** 이란? 

  - **생체의 신경망을 흉내 낸 인공지능이다.**

  - 입력, 은닉, 출력 계층으로 구성되어 있으며 은닉 계층을 한 개 이상 포함할 수 있다.

  - 초기에는 기술적인 한계로 은닉 계층을 한 개만 포함하여 전체 3개의 계층으로 ANN을 구성했다. 

  - 넓은 의미로 인공 신경망을 총칭하는 용어로 ANN을 사용하기도해서 단일 은닉 계층의 ANN을 얉은 신경망으로 구분해서 부르기도 한다.
   
   
## 2.1 ANN의 원리 ## 

### 2.1.1 ANN의 개념 ### 

ANN은 생체 신경망 구조와 유사하게 은닉 계층을 포함하는 인공신경망 기술이다. 

초기에는 은닉 계층이 하나였다. 은닉 계층이 둘 이상이면 가중치 최적화가 어려워 신경망의 성능을 보장할 수 없었기 때문이다.

과거에 가중치 최적화에 대한 연구가 활발하지 못했던 이유로는 충분하지 못한 데이터양도 있다. 빅데이터 시대 이전에는 데이터 양이 많지 않았기 때문이다.

그리고 스몰데이터에는 신경망 대신할 다신 머신러닝 방법이 존재했다. 예를 들어 SVM은 데이터가 적을 때 아주 우수한 성능을 보인다.

그렇지만 처리할 데이터양이 늘어나거나 비정형 데이터인 경우는 복잡도가 높아서 활용하기가 쉽지 않다 => 이런 경우 **ANN이 더 효과적이다.**

### 2.1.2 ANN 구조 ### 

은닉 계층이 하나인 ANN으로 기본 구조를 살펴보자.

ANN은 **입력계층, 은닉계층, 출력계층**으로 구성되고 각 계층은 순서별로 여러 입력노드, 은닉노드, 출력노드를 포함한다.

< 동작 순서 >

1. 입력 계층을 통해 외부로부터 들어온 입력 신호 벡터(x)에 ㅈ가중치 행렬 W_xh를 곱하여 은닉 계층으로 보낸다.

2. 은닉 계층의 각 노드들은 자신에게 입력된 신호 벡터에 **활성화 함수**인 f_n()를 적용한 결과 벡터(h)로 내보낸다. 활성화 함수에는 시그모이드, 하이퍼볼릭탄센트 함수 등이 있다.

3. 은닉 계층의 결과 벡터에 새로운 가중치 행렬 W_hy를 곱한 뒤 출력 계층으로 보낸다.

4. 출력 계층으로 들어온 신호 벡터에 출력 활성화 함수인 f_y()를 적용하고 그 결과 벡터(y)를 신경망 외부로 최종 출력한다. 분류의 경우에는 출력용 활성화 함수로 **소프트맥스** 연산을 주로 사용한다.

![image](https://user-images.githubusercontent.com/66320010/119773060-10a13080-befb-11eb-9f3f-d0251d8f2a89.png)

### 2.1.3 ANN 활용 ### 

ANN의 기본적인 활용 방법은 **분류**와 **회귀**로 나눌 수 있다. 

  - 분류 ANN : 입력 정보를 클래스 별로 분류하는 방식 -> ex) 필기체 숫자를 0부터 9로 분류하기
  - 회귀 ANN : 입력 정보로 다른 값을 예측하는 방식 -> ex) 최근 일주일간 평균 온도로 내일 평균 온도 예측하기

#### [ 분류 ANN ] ####

분류 ANN이란?

- 입력 정보를 바탕으로 해당 입력이 어느 클래스에 속하는지를 결정하는 것

- 예를 들어 필기체 숫자가 적힌 그림을 보고 어느 숫자인지 분류하는 경우

- 입력 계층은 필기체 숫자를 받아들이고 출력 계층은 분류한 결과를 출력한다.

- 분류 결과를 출력하는 방법으로 노드 하나를 사용해 분류 결과를 수로 표현하는 방법이 있다. 그러나 분류 ANN은 숫자로 출력하는 방법보다 분류할 클래스 수만큼 출력 노드를 만드는 방법이 효과적이라고 알려져 있다.

- 따라서 만약 0과 1 두 숫자에 해당하는 필기체 그림을 분류하는 경우에는 출력 노드를 두 개 만드는 것이 효과적이다.

- 판별은 두 출력 노드의 값을 비교하여 더 큰 쪽을 선택하도록 구현한다.

**이와 같이 ANN을 이용하여 예측값을 추론하는 과정을 전방향 예측이라고 한다. 반면 ANN을 구성하는 가중치의 학습은 예측값의 목표값에 대한 오차를 역방향으로 되돌리면서 이루어지기 때문에 오차역전파라고 한다.**

오차 역전파 : 오차를 줄이는 경사 하강법(gradient descent)에서 유도된 방법이다. 경사 하강법은 가중치에 대한 손실 함수를 미분하고 그 미분값의 방향과 크기를 사용해 가중치를 보상하는 방법이다.*

손실 함수(loss function) : 가중치에 따라 오차가 얼마나 커지는지 작아지는지를 평가한다. 

분류 ANN은 손실함수로 교차 엔트로피(cross entropy)함수를 주로 사용한다. 교차 엔트로피 함수를 적용하려면 출력 노드의 결과를 확률 값으로 바꿔야 한다. 확률 값은 출력 노드 값을 소프트맥스 연산으로 구한다.











