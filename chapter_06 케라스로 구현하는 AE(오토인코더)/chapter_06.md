# Chapter 06 #

π“ μ¤ν† μΈμ½”λ”λ€?

- λΉ„μ§€λ„ν•™μµ μΈκ³µμ§€λ¥μ΄λ‹¤. μ§€κΈκΉμ§€ λ‹¤λ£¬ λ¨λΈλ“¤μ€ λ©ν‘κ°’μΌλ΅ ν•™μµν•λ” μ§€λ„ν•™μµ μΈκ³µμ§€λ¥μ΄μ—λ‹¤.

- μ§€λ„ν•™μµκ³Ό λ‹¤λ¥΄κ² λΉ„μ§€λ„ν•™μµμ€ μ…λ ¥ λ°μ΄ν„°λ¥Ό κ°€κ³µν•μ—¬ λ©ν‘κ°’μ„ μ¶λ ¥ν•λ” λ°©μ‹μ΄ μ•„λ‹λΌ λ μ΄λΈ” μ •λ³΄κ°€ μ—†λ” λ°μ΄ν„°μ νΉμ„±μ„ λ¶„μ„ν•κ±°λ‚ μ¶”μ¶ν•λ‹¤.

- λΉ„μ§€λ„ν•™μµμ λ€ν‘μ μΈ λ°©μ‹μΈ μ¤ν† μΈμ½”λ”(AE)μ λ©μ μ€ μ…λ ¥ λ°μ΄ν„°μ νΉμ§•μ μ„ ν¨μ¨μ μΌλ΅ μ°Ύλ” κ²ƒμ΄λ‹¤.

- λ‹¤μ°¨μ› μ…λ ¥ λ°μ΄ν„°λ¥Ό μ €μμ› λ¶€νΈλ΅ λ°”κΎΈκ³  λ‹¤μ‹ μ €μ°¨μ› λ¶€νΈλ¥Ό μ²μ μ…λ ¥ν• λ‹¤μ°¨μ› λ°μ΄ν„°λ΅ λ°”κΎΈλ©΄μ„ νΉμ§•μ λ“¤μ„ μ°Ύμ•„λ‚Έλ‹¤.

- AEμ μ¶λ ¥ λ°μ΄ν„°λ” μ…λ ¥ν• λ°μ΄ν„°μ— λΉ„ν•΄ μ •λ³΄μ μ°¨μ›μ΄ μ¤„κΈ° λ•λ¬Έμ— μ΅μμ„ μ κ±°ν•λ” μ©λ„λ΅λ„ μ‚¬μ©ν•  μ μλ‹¤.

## 6.1 AEμ μ›λ¦¬ ##

**μ¤ν† μΈμ½”λ”**λ” μ…λ ¥ν• λ°μ΄ν„°λ¥Ό λ¶€νΈν™”ν• ν›„ λ³µνΈν™”ν•λ” μ‹ κ²½λ§μ΄λ‹¤.

κ·Έ κ²°κ³Ό μ…λ ¥ λ°μ΄ν„°μ νΉμ§•μ μ„ μ¶”μ¶ν•λ‹¤. 

μ£Όλ΅ ν™μ©λλ” κ³³μ€ λ°μ΄ν„° μ••μ¶•, μ €μ°¨μ›ν™”λ¥Ό ν†µν• λ°μ΄ν„° κ΄€κ³„ κ΄€μ°°, λ°°κ²½ μ΅μ μ–µμ  λ“±μ…λ‹λ‹¤.

AEλ” μ£Όμ„±λ¶„ λ¶„μ„μΌλ΅ μ²λ¦¬ν•λ” μΌμ°¨μ› λ°μ΄ν„° μ²λ¦¬ λ°©μ‹μ„ λ”¥λ¬λ‹ λ°©μ‹μΌλ΅ ν™•μ¥ν• κ²ƒμ΄λ‹¤.

AEλ” μ‹ κ²½λ§μΌλ΅ νΉμ§•μ μ„ μ¶”μ¶ν•κΈ° λ•λ¬Έμ— λ°μ΄ν„° κµ¬μ„±μ΄ λ³µμ΅ν•κ±°λ‚ λ°μ΄ν„°κ°€ λ€λ‰μΈ κ²½μ°μ— μ£Όμ„±λ¶„ λ¶„μ„ λ°©λ²•λ³΄λ‹¤ λ” ν¨κ³Όμ μ΄λ‹¤.

AEμ λ™μ‘μ€ **λ¶€νΈν™” κ³Όμ •**κ³Ό **λ³µνΈν™” κ³Όμ •**μΌλ΅ μ΄λ£¨μ–΄μ§„λ‹¤.

  - λ¶€νΈν™” κ³Όμ • 

    1. μ…λ ¥ κ³„μΈµμ—μ„ λ“¤μ–΄μ¨ λ‹¤μ°¨μ› λ°μ΄ν„°λ” μ°¨μ›μ„ μ¤„μ΄λ” μ€λ‹‰ κ³„μΈµμΌλ΅ λ“¤μ–΄κ°„λ‹¤.
    2. μ€λ‹‰ κ³„μΈµμ μ¶λ ¥μ΄ κ³§ λ¶€νΈν™” κ²°κ³Όμ΄λ‹¤.

  - λ³µνΈν™” κ³Όμ •

    1. μ€λ‹‰ κ³„μΈµμ—μ„ μ¶λ ¥ν• λ¶€νΈν™” κ²°κ³Όλ” μ¶λ ¥ κ³„μΈµμΌλ΅ λ“¤μ–΄κ°„λ‹¤. μ΄λ• μ¶λ ¥ κ³„μΈµμ λ…Έλ“ μλ” μ€λ‹‰ κ³„μΈµμ λ…Έλ“ μλ³΄λ‹¤ λ§λ‹¤. μ¦‰, λ” λ†’μ€ μ°¨μ›μ λ°μ΄ν„°λ΅ λλμ•„κ°„λ‹¤.
    2. μ¶λ ¥ κ³„μΈµμ€ μ…λ ¥ κ³„μΈµκ³Ό λ…Έλ“ μκ°€ λ™μΌν•λ‹¤.

β–¶ μ΄κ²ƒκ³Ό κ°™μ΄ AEλ” λ°μ΄ν„°μ μ°¨μ›μ„ μ¤„μ€λ‹¤κ°€ λλ ¤ λ¶€νΈν™”μ™€ λ³µνΈν™”κ°€ μ—°μ†μ μΌλ΅ μΌμ–΄λ‚κ² λλ‹¤. AEμ λ¶€νΈν™” λ° λ³µνΈν™” κ³Όμ •μ— μ‚¬μ©λλ” μ€λ‹‰ κ³„μΈµ μλ” μ—¬λΏμΌ μ μλ‹¤.

## 6.2 μ™„μ „ μ—°κ²° κ³„μΈµμ„ μ΄μ©ν• AE κµ¬ν„ ##

MNIST(ν•„κΈ°μ²΄ μ«μ)λ¥Ό μ΄μ©ν•μ—¬ AEλ¥Ό κµ¬ν„ν•΄λ³΄μ. 

AEλ¥Ό κµ¬μ„±ν•λ” κ³„μΈµμ΄ μ™„μ „ μ—°κ²° κ³„μΈµμ΄λΌκ³  κ°€μ •ν•μ. 

μ΄λ² μ μ ν•µμ‹¬μ€ **AEκ°€ ν•„κΈ°μ²΄ μ«μλ¥Ό μ°¨μ›μ΄ μ‘μ€ λ°μ΄ν„°λ΅ λ¶€νΈν™”ν• λ’¤ μ›λ μ΄λ―Έμ§€μ™€ μ μ‚¬ν•κ² λ‹¤μ‹ λ³µνΈν™”ν•  μ μλλƒμ΄λ‹¤.**

λ³µκµ¬κ°€ μ λλ‹¤λ©΄ ν•„κΈ°μ²΄ μ«μλ” μ°¨μ›μ΄ μ¤„μ–΄λ“  λ¶€νΈν™” λ°μ΄ν„°λ΅ λ³€κ²½μ΄ κ°€λ¥ν•κ³  μ΄ν›„λ” μ΄ μ¤„μ–΄λ“  λ¶€νΈλ΅ μ •λ³΄ μ „λ‹¬ λλ” λ°μ΄ν„° λ¶„λ¥ λ“±μ μ²λ¦¬κ°€ κ°€λ¥ν•΄μ§„λ‹¤.

μ™„μ „ μ—°κ²° κ³„μΈµ AEλ” λ‹¤μκ³Ό κ°™μ€ μμ„λ΅ κµ¬ν„ν•λ‹¤.

1) μ™„μ „ μ—°κ²° κ³„μΈµ AE λ¨λΈλ§
2) λ°μ΄ν„° μ¤€λΉ„
3) μ™„μ „ μ—°κ²° κ³„μΈµ AE ν•™μµ
4) ν•™μµ ν¨κ³Ό λ¶„μ„
5) μ™„μ „ μ—°κ²° κ³„μΈµ AE λ™μ‘ ν™•μΈ

### 6.2.1 μ™„μ „ μ—°κ²° κ³„μΈµ AE λ¨λΈλ§ ###

1οΈβƒ£ AEλ¥Ό μ„ν• λ”¥λ¬λ‹ λ¨λΈμ„ λ§λ“ λ‹¤. μ°μ„  λ¨λΈλ§μ— ν•„μ”ν• μΌ€λΌμ¤ μ„λΈ ν¨ν‚¤μ§€λ“¤μ„ λ¶λ¬μ¨λ‹¤.

    from keras import layers,models
    
- μ΄μ  κ°μ²΄λ¥Ό κµ¬μ„±ν•μ—¬ AE λ¨λΈλ§μ„ μν–‰ν•λ‹¤.

      class AE(models.Model):
        def __init__(self,x_nodes, z_dim):
          x_shape = (x_nodes,)
          
     - κ°μ²΄μ μ΄κΉƒκ°’μΌλ΅ μ…λ ¥ λ…Έλ“ μ(x_nodes), μ€λ‹‰ λ…Έλ“ μ(z_dim)λ¥Ό μ§€μ •ν–λ‹¤.
     - μ…λ ¥ κ³„μΈµμ κµ¬μ΅°λ¥Ό λ‚νƒ€λ‚΄λ” x_shapeμ€ μ…λ ¥ λ…Έλ“ μ(x_node)λ΅ κµ¬μ„±λ νν”λ΅ μ •μν–λ‹¤.
     
     β— νμ΄μ¬ λ°°μ—΄μ€ 3κ°€μ§€μ΄λ‹¤. κ°€μ¥ κ°„λ‹¨ν• κ²ƒμ΄ **νν”**μ΄λ‹¤. νν”μ€ (a,b,c)μ™€ κ°™μ΄ κ΄„νΈλ¥Ό μ΄μ©ν•΄ κµ¬μ„±ν•λ‹¤. λ‚λ¨Έμ§€ λ‘μ€ λ€κ΄„νΈλ΅ κµ¬μ„±ν•λ” **λ¦¬μ¤νΈ(list)** μ™€ μ¤‘κ΄„νΈλ΅ κµ¬μ„±ν•λ” **λ”•μ…”λ„λ¦¬(dictionary)** κ°€ μλ‹¤.

- AEμ μ…λ ¥ κ³„μΈµ, μ€λ‹‰ κ³„μΈµ, μ¶λ ¥ κ³„μΈµμ„ μ •μν•  λ‹¨κ³„μ΄λ‹¤.

      x = layers.Input(shape = x_shape)  # μ…λ ¥ κ³„μΈµ
      z = layers.Dense(z_dim, activation='relu')   # μ€λ‹‰ κ³„μΈµ
      y = layers.Dense(x_nodes, activation='sigmoid')   # μ¶λ ¥ κ³„μΈµ

    - μ…λ ¥ κ³„μΈµκ³Ό μ¶λ ¥ κ³„μΈµμ λ…Έλ“ μλ¥Ό κ°™κ² κµ¬μ„±ν•μ€λ‹¤. 
    
    - μ¤‘κ°„μ— λ“¤μ–΄ μλ” μ€λ‹‰ κ³„μΈµμ€ z_dimκ°’μ— λ”°λΌ λ…Έλ“ μκ°€ μ •ν•΄μ§„λ‹¤.
    
    - μ€λ‹‰ κ³„μΈµμ ν™μ„±ν™” ν•¨μλ” ReLUλ΅ μ„¤μ •ν–κ³  μ¶λ ¥ κ³„μΈµμ ν™μ„±ν™” ν•¨μλ” μ‹κ·Έλ¨μ΄λ“λ΅ μ§€μ •ν–λ‹¤(μ‹κ·Έλ¨μ΄λ“ μ§€μ • μ΄μ  : μ…λ ¥ μ΄λ―Έμ§€μ νΉμ„±μ„ λ°μν•κΈ° μ„ν•΄μ„).
    
    - κ·Έλ¦¬κ³  μ…λ ¥μΌλ΅ μ‚¬μ©ν•  MNIST μ΄λ―Έμ§€λ” μ™„μ „ ν°μƒ‰ λλ” μ™„μ „ κ²€μ€μƒ‰μ— κ°€κΉμ΄ μƒ‰μΌλ΅ κµ¬μ„±λμ–΄ μκΈ° λ•λ¬Έμ΄λ‹¤. λ§μ•½ ν”½μ…€λ“¤μ΄ ν°μƒ‰κ³Ό κ²€μ€μƒ‰ μ‚¬μ΄μ νμƒ‰μΌλ΅ κ³¨κ³ λ£¨ λ¶„ν¬ν•λ” κ²½μ°μ—λ” μ¶λ ¥ κ³„μΈµμ ν™μ„±ν™” ν•¨μλ΅ μ„ ν• ν•¨μκ°€ λ” μ ν•©ν•λ‹¤.

- AEμ κµ¬μ΅°λ¥Ό ν™•μ •ν•κ³  μ»΄νμΌν•λ‹¤.

      super().__init__(x,y)
      self.compile(optimizer = 'adadelta', loss = 'binary_crossentropy'

  - μ†μ‹¤ ν•¨μλ¥Ό binary_crossentropyλ΅ μ„¤μ •ν–λ‹¤. κµμ°¨ μ—”νΈλ΅ν”Όλ” λ¶„λ¥ λ¬Έμ μ— μ£Όλ΅ μ‚¬μ©ν•μ§€λ§ μ΄ μμ μ—μ„λ” AEμ©μΌλ΅λ„ μ‚¬μ©ν–λ‹¤.

- AEλ¨λΈλ§κ³Ό μ§μ ‘ μƒκ΄€μ€ μ—†μ§€λ§ μ¶”ν›„μ— AE λ™μ‘μ„ ν™•μΈν•λ” λ° ν•„μ”ν• λ¶€λ¶„μ„ κµ¬ν„ν•λ‹¤.

β” AEλ¥Ό κµ¬μ„±ν•λ” νΉμ • κ³„μΈµμ μ¶λ ¥ κ°’μ„ λ½‘μ•„λ‚΄κ±°λ‚ νΉμ • κ³„μΈµμ— μƒλ΅μ΄ μ…λ ¥κ°’μ„ λ„£μ–΄μ„ κ²°κ³Όλ¥Ό λ³΄λ” λ°©λ²•μ„ λ‹¤λ£¬λ‹¤. μ΄λ¥Ό κµ¬ν„ν•λ ¤λ©΄ κ°μ²΄μ μ΄κΈ°ν™” ν•¨μμ—μ„ ν•„μ”ν• κ³„μΈµλ“¤κ³Ό λ‡λ‡ μ΄κΈ° νλΌλ―Έν„°λ¥Ό μ €μ¥ν•΄λ‘ ν•„μ”κ°€ μλ‹¤.

    self.x = x
    self.z = z
    self.z_dim = z_dim
    
   - μ…λ ¥ κ³„μΈµ, μ€λ‹‰ κ³„μΈµ, μ€λ‹‰ κ³„μΈµμ λ…Έλ“ μλ¥Ό κ°μ²΄ λ©¤λ²„ λ³€μλ΅ μ €μ¥ν–λ‹¤.

- AEλ” λ³µνΈν™”μ™€ λ¶€νΈν™”κ°€ μλ™μΌλ΅ μν–‰λλ” λ¨λΈμ΄λ‹¤. λ¶€νΈν™”κ°€ μ–΄λ–»κ² μ§„ν–‰λλ”μ§€ μ•κ³ μ‹¶μ„ λ•λ” AEμ¤‘κ°„μ— μλ” μ€λ‹‰ κ³„μΈµμ΄ κ²°κ³Όλ¥Ό μ¶λ ¥μΌλ΅ ν•λ” λ³„λ„μ λ¶€νΈν™” λ¨λΈμ„ μ„¤μ •ν•΄ μ‹ κ²½λ§ μ™Έλ¶€μ—μ„ λ¶€νΈν™”ν• κ²°κ³Όλ¥Ό ν™•μΈν•  μ μλ‹¤.

      def Encoder(self):
        return models.Model(self.x,self.z)

- μ™Έλ¶€μ—μ„ μƒλ΅μ΄ λ¶€νΈν™” λ°μ΄ν„°λ¥Ό λ„£μ–΄ λ³µνΈν™”ν•λ” κ²°κ³Όλ¥Ό μ–»λ” λ°©λ²•λ„ μ κ³µν•λ‹¤. μ΄λ¥Ό μ„ν•΄μ„ λ¨λ‹ν„°λ§μ„ μ κ³µν•  λ³„λ„ λ³µνΈν™” λ¨λΈμ„ λ§λ“ λ‹¤. μ΄ λ³µνΈν™” λ¨λΈμ€ μƒλ΅­κ² μ…λ ¥μ„ μ •μν•κ³  μ „μ²΄ AEλ¨λΈμ—μ„ λ³µνΈν™” κ³„μΈµμ„ κ°€μ Έμ™€ λ§λ“ λ‹¤.

      def Decoder(self):
        z_shape = (self.z_dim,)
        z = layers.Input(shape= z_shape)
        y_layer = self.layers[-1]
        y = y_layer(z)
        return models.Model(z,y)
  
  - μ™Έλ¶€μ— μƒλ΅­κ² λ“¤μ–΄μ¤λ” μ…λ ¥μ— λ€μ‘ν•λ―€λ΅ μƒλ΅μ΄ μ…λ ¥μ„ Input()μΌλ΅ λ§λ“¤μ—λ‹¤.

  - κ·Έλ¦¬κ³  λ‹¤μ μ€λ‹‰ κ³„μΈµμ€ κΈ°μ΅΄μ— μ‚¬μ©ν•λ μ€λ‹‰ κ³›γ…‡μ„ λ‹¤μ‹ μ‚¬μ©ν•κΈ° λ•λ¬Έμ— κΈ°μ΅΄μ— λ§λ“  κ³„μΈµ μ¤‘ ν•λ‚λ¥Ό λ³€μ selfμ—μ„ κ°€μ Έμ™”λ‹¤.

  - self.layers[-1]μ€ μ μΌ λ§μ§€λ§‰ λ¶€λ¶„ μ¦‰ AE μμ‹ μ μ¶λ ¥ κ³„μΈµμ΄λΌλ” μλ―Έμ΄λ‹¤.

β… μ§€κΈκΉμ§€ **AE κ³ μ  λ¨λΈκ³Ό λ¶€νΈν™”μ™€ λ³µνΈν™”λ¥Ό κ°κ° μν–‰ν•λ” μ¶”κ°€ λ¨λΈμ„ λ§λ“¤μ—λ‹¤.** κ³ μ  λ¨λΈμ„ λ§λ“¤ λ• κ³µν†µ νλΌλ―Έν„°λ¥Ό μκΈ° λ©¤λ²„ λ³€μλ΅ μ§€μ •ν•΄λ‘μ–΄ μ†μ‰½κ² μ¶”κ°€ λ¨λΈμ„ κµ¬ν„ν•  μ μμ—λ‹¤.









